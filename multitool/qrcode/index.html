<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>QR-–∫–æ–¥ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä | –ó–≤–∞—Ä–∏—á–µ–Ω–∫–æ –î–∞—Ä—å—è</title>
  <!-- –ü—É—Ç—å –∫ –∏–∫–æ–Ω–∫–µ -->
  <link rel="icon" href="../../img/favicon.png" type="image/x-icon">
  
  <!-- –®—Ä–∏—Ñ—Ç—ã -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- –°–∫—Ä–∏–ø—Ç—ã QR (–≤–∞—à–∏ —Å—Ç–∞—Ä—ã–µ) -->
  <script src="../../js/script.js" defer></script>
  <script src="../../js/qrcode.js" defer></script>
  <script src="https://unpkg.com/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>

  <!-- –°—Ç–∏–ª–∏ (–¢–æ—á—å-–≤-—Ç–æ—á—å –∫–∞–∫ CubeKey + –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ QR) -->
  <style>
    :root {
      --color-bg-light: #f4f6f9;
      --color-bg-dark: #121217;
      --color-primary-light: #5a4fcf;
      --color-primary-dark: #4865d6;
      --color-text-light: #333;
      --color-text-dark: #ddd;
      --shadow-subtle: rgba(90, 79, 207, 0.08);
      --shadow-dark: rgba(0, 0, 0, 0.3);
      --color-panel-light: #ffffff;
      --color-panel-dark: #1e1e24;
      --color-input-light: #f8f9fa;
      --color-input-dark: #2a2a35;
      
      /* –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (—Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞) */
      --bg-body: var(--color-bg-light);
      --bg-panel: var(--color-panel-light);
      --color-text: var(--color-text-light);
      --color-primary: var(--color-primary-light);
      --shadow-card: 0 10px 30px var(--shadow-subtle);
      --bg-input: var(--color-input-light);
      --border-color: #e0e0e0;
    }

    /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ */
    body.dark-mode {
      --bg-body: var(--color-bg-dark);
      --bg-panel: var(--color-panel-dark);
      --color-text: var(--color-text-dark);
      --color-primary: var(--color-primary-dark);
      --shadow-card: 0 10px 30px var(--shadow-dark);
      --bg-input: var(--color-input-dark);
      --border-color: #333;
    }

    body {
      margin: 0;
      font-family: "Segoe UI", Arial, sans-serif;
      background-color: var(--bg-body);
      color: var(--color-text);
      transition: background-color 0.3s, color 0.3s;
      padding-bottom: 80px; /* –ú–µ—Å—Ç–æ –ø–æ–¥ –ª–∞–º–ø–æ—á–∫—É */
    }

    * { box-sizing: border-box; }

    /* === –®–ê–ü–ö–ê (CubeKey Style) === */
    .header-wrapper {
      /* –§–æ–Ω —à–∞–ø–∫–∏: –≥—Ä–∞–¥–∏–µ–Ω—Ç –∫–∞–∫ —É CubeKey, –Ω–æ –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å */
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); 
      /* –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ "–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π" –∏ —É–∑–æ—Ä: */
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      
      padding: 40px 20px;
      text-align: center;
      color: white;
      border-bottom-left-radius: 30px;
      border-bottom-right-radius: 30px;
      margin-bottom: 40px;
      box-shadow: 0 10px 30px rgba(118, 75, 162, 0.3);
      position: relative;
      overflow: hidden;
    }
    
    /* –£–∑–æ—Ä —à–∞–ø–∫–∏ */
    .header-wrapper::before {
      content: '';
      position: absolute; top:0; left:0; width:100%; height:100%;
      background-image: 
        radial-gradient(rgba(255,255,255,0.1) 1px, transparent 1px),
        radial-gradient(rgba(255,255,255,0.1) 1px, transparent 1px);
      background-position: 0 0, 20px 20px;
      background-size: 40px 40px;
      opacity: 0.6;
    }

    .header-content {
      position: relative;
      z-index: 2;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
    }

    .logo-block {
      display: flex;
      align-items: center;
      gap: 15px;
      font-size: 2rem;
      font-weight: 700;
      color: #fff;
      text-decoration: none;
    }
    .logo-block img { height: 50px; width: auto; }

    .page-title {
      font-size: 1.5rem;
      color: var(--color-primary);
      text-align: center;
      margin-bottom: 30px;
      font-weight: 700;
    }

    /* === –°–ï–¢–ö–ê (GRID) === */
    .main-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
      display: grid;
      grid-template-columns: 1fr 1fr; /* –î–≤–µ –∫–æ–ª–æ–Ω–∫–∏ –∫–∞–∫ –≤ CubeKey */
      gap: 30px;
      align-items: start;
    }

    /* –ö–ê–†–¢–û–ß–ö–ò */
    .card {
      background: var(--bg-panel);
      border-radius: 20px;
      padding: 30px;
      box-shadow: var(--shadow-card);
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    /* –°–µ–∫—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–µ–∫ */
    .section-title {
      font-size: 0.95rem;
      color: var(--color-text);
      margin-bottom: 12px;
      font-weight: 600;
      display: block;
    }

    .control-row {
      margin-bottom: 24px;
    }
    
    /* –ü–æ–ª—è –≤–≤–æ–¥–∞ (–∫–∞–∫ CubeKey) */
    input[type="text"],
    input[type="url"],
    select, 
    textarea {
      width: 100%;
      padding: 12px 16px;
      border: 1px solid transparent;
      background: var(--bg-input);
      border-radius: 12px;
      font-size: 1rem;
      color: var(--color-text);
      font-family: inherit;
      transition: 0.2s;
    }
    input:focus, select:focus, textarea:focus {
      outline: none;
      background: var(--bg-panel);
      box-shadow: 0 0 0 2px var(--color-primary);
    }

    /* –¶–≤–µ—Ç–∞ (Color Picker) */
    .color-group {
      display: flex;
      gap: 15px;
    }
    .color-item {
      flex: 1;
      background: var(--bg-input);
      border-radius: 12px;
      padding: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    input[type="color"] {
      border: none; width: 32px; height: 32px; padding: 0; background: none; cursor: pointer;
    }
    .hex-val {
      font-size: 0.9rem; font-family: monospace; border: none; background: transparent; width: 70px;
    }

    /* –ß–µ–∫–±–æ–∫—Å (CubeKey style) */
    .checkbox-label {
      display: flex; align-items: center; gap: 10px; cursor: pointer; margin-top: 10px; font-size: 0.95rem;
    }
    .checkbox-label input { display: none; }
    .cb-custom {
      width: 20px; height: 20px;
      border: 2px solid #ccc; border-radius: 6px;
      position: relative; transition: 0.2s;
    }
    .checkbox-label input:checked + .cb-custom {
      background: var(--color-primary); border-color: var(--color-primary);
    }
    .checkbox-label input:checked + .cb-custom::after {
      content: ''; position: absolute; top: 2px; left: 6px; width: 4px; height: 9px;
      border: solid white; border-width: 0 2px 2px 0; transform: rotate(45deg);
    }

    /* Range Slider */
    input[type=range] {
      width: 100%; background: transparent; -webkit-appearance: none; margin-top: 10px;
    }
    input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none; height: 16px; width: 16px; border-radius: 50%;
      background: var(--color-primary); cursor: pointer; margin-top: -6px;
    }
    input[type=range]::-webkit-slider-runnable-track {
      width: 100%; height: 4px; background: #ddd; border-radius: 2px;
    }

    /* PREVIEW CARD (Right side) */
    .preview-wrapper {
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: var(--bg-input); /* –°–µ—Ä—ã–π —Ñ–æ–Ω –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞ */
      border-radius: 16px;
      padding: 40px;
      min-height: 300px;
      margin-bottom: 20px;
    }
    
    #qrWrapper {
      background: #fff;
      padding: 10px;
      border-radius: 12px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    }

    .btns-grid {
      display: grid; grid-template-columns: 1fr 1fr; gap: 15px;
    }
    .btn-main {
      background: var(--color-primary);
      color: #fff; border: none; padding: 12px;
      border-radius: 12px; font-weight: 600; cursor: pointer;
      transition: 0.2s;
    }
    .btn-main:hover { opacity: 0.9; transform: translateY(-2px); }

    .btn-sec {
      background: transparent; border: 1px solid var(--border-color);
      color: var(--color-text); padding: 8px; border-radius: 8px;
      cursor: pointer; width: 100%; transition: 0.2s;
    }
    .btn-sec:hover { background: var(--bg-input); }

    /* –õ–ê–ú–ü–û–ß–ö–ê (–í–Ω–∏–∑—É —Å–ø—Ä–∞–≤–∞) */
    .theme-toggle {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 50px; height: 50px;
      border-radius: 50%;
      background: var(--color-primary);
      box-shadow: 0 5px 20px rgba(90, 79, 207, 0.4);
      border: none;
      cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      color: #fff;
      z-index: 1000;
      transition: transform 0.3s;
    }
    .theme-toggle:hover { transform: scale(1.1); }
    .theme-toggle svg { width: 24px; height: 24px; fill: currentColor; }

    /* –ê–¥–∞–ø—Ç–∏–≤ */
    @media (max-width: 900px) {
      .main-container { grid-template-columns: 1fr; }
      .header-wrapper { padding: 30px 15px; border-radius: 0 0 20px 20px; }
    }
  </style>
  
  <!-- Yandex.Metrika -->
  <script type="text/javascript">
    (function (m, e, t, r, i, k, a) {
      m[i] = m[i] || function () { (m[i].a = m[i].a || []).push(arguments) };
      m[i].l = 1 * new Date();
      for (var j = 0; j < document.scripts.length; j++) { if (document.scripts[j].src === r) { return; } }
      k = e.createElement(t), a = e.getElementsByTagName(t)[0], k.async = 1, k.src = r, a.parentNode.insertBefore(k, a)
    })
      (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(103335861, "init", {
      clickmap: true,
      trackLinks: true,
      accurateTrackBounce: true,
      webvisor: true
    });
  </script>
  <noscript><div><img src="https://mc.yandex.ru/watch/103335861" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

</head>

<body>

  <!-- –®–∞–ø–∫–∞ (–ü–∞—Ç—Ç–µ—Ä–Ω CubeKey) -->
  <header class="header-wrapper">
    <div class="header-content">
      <a href="../../" class="logo-block">
        <img src="../../img/logo.png" alt="–õ–æ–≥–æ">
        <span>–ó–≤–∞—Ä–∏—á–µ–Ω–∫–æ –î–∞—Ä—å—è</span>
      </a>
    </div>
  </header>
  
  <div class="page-title">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä QR-–∫–æ–¥–æ–≤</div>

  <main class="main-container">
    
    <!-- –õ–ï–í–ê–Ø –ö–ê–†–¢–û–ß–ö–ê (–í–º–µ—Å—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–∞—Ä–æ–ª—è) -->
    <div class="card">
      
      <div class="control-row">
        <label class="section-title">–°—Å—ã–ª–∫–∞ (URL)</label>
        <input type="url" id="urlInput" placeholder="https://example.com" value="https://example.com">
      </div>

      <div class="control-row">
        <label class="section-title">–¶–≤–µ—Ç–∞</label>
        <div class="color-group">
          <div class="color-item">
            <span>–§–æ–Ω</span>
            <input type="color" id="bgColor" value="#ffffff">
          </div>
          <div class="color-item">
            <span>QR</span>
            <input type="color" id="dotColor" value="#000000">
          </div>
        </div>
        <label class="checkbox-label">
          <input type="checkbox" id="bgTransparency">
          <div class="cb-custom"></div>
          –ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω
        </label>
      </div>

      <div class="control-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
        <div>
          <label class="section-title">–§–æ—Ä–º–∞ —Ç–æ—á–µ–∫</label>
          <select id="dotShape">
            <option value="square">–ö–≤–∞–¥—Ä–∞—Ç</option>
            <option value="dots">–ö—Ä—É–≥</option>
            <option value="classy">–°–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–µ</option>
            <option value="rounded">–ú—è–≥–∫–∏–µ</option>
            <option value="extra-rounded">–ü–æ–¥—É—à–∫–∞</option>
          </select>
        </div>
        <div>
          <label class="section-title">–£–≥–ª—ã</label>
          <select id="markerShape">
            <option value="square">–ö–≤–∞–¥—Ä–∞—Ç</option>
            <option value="dot">–ö—Ä—É–≥</option>
          </select>
        </div>
      </div>

      <div class="control-row">
        <label class="section-title">–õ–æ–≥–æ—Ç–∏–ø</label>
        <input type="text" id="logoInput" placeholder="URL –∫–∞—Ä—Ç–∏–Ω–∫–∏" style="margin-bottom: 10px;">
        <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–¥ –∏–Ω–ø—É—Ç -->
        <div style="position: relative;">
          <input type="file" id="logoFile" accept="image/*" style="position: absolute; width: 100%; height: 100%; opacity: 0; cursor: pointer;">
          <button class="btn-sec" style="text-align: center;">üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</button>
        </div>
        
        <div id="logoPreviewBlock" style="display:none; margin-top:10px; position: relative; width: max-content;">
          <img id="logoPreview" style="height: 50px; border-radius: 8px; border: 1px solid #eee;">
          <button id="removeLogo" style="position:absolute; top:-5px; right:-5px; background:red; color:#fff; border:none; border-radius:50%; width:20px; height:20px; cursor:pointer;">√ó</button>
        </div>

        <label class="section-title" style="margin-top: 15px;">–†–∞–∑–º–µ—Ä –ª–æ–≥–æ—Ç–∏–ø–∞</label>
        <input type="range" id="logoSize" min="1" max="25" value="15">
      </div>

    </div>

    <!-- –ü–†–ê–í–ê–Ø –ö–ê–†–¢–û–ß–ö–ê (–í–º–µ—Å—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞) -->
    <div class="card">
      <label class="section-title" style="text-align: center;">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</label>
      
      <div class="preview-wrapper">
        <div id="qrWrapper">
          <div id="qr-code"></div>
        </div>
      </div>

      <div class="btns-grid">
        <button class="btn-main" data-type="png">PNG</button>
        <button class="btn-main" data-type="svg">SVG</button>
        <button class="btn-main" data-type="jpg">JPG</button>
        <button class="btn-main" data-type="pdf">PDF</button>
      </div>

      <div style="margin-top: 30px;">
        <label class="section-title">–ö–æ–¥ –Ω–∞—Å—Ç—Ä–æ–µ–∫ (Base64)</label>
        <textarea id="seedArea" style="height: 80px; font-family: monospace; font-size: 0.85rem;"></textarea>
        <div style="display: flex; gap: 10px; margin-top: 10px;">
          <button class="btn-sec" id="copySettings">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
          <button class="btn-sec" id="loadSettingsBtn">–í—Å—Ç–∞–≤–∏—Ç—å</button>
        </div>
      </div>
    </div>

  </main>

  <!-- –õ–ê–ú–ü–û–ß–ö–ê (–ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ –¢–ï–ú–´) -->
  <button class="theme-toggle" id="themeToggle" title="–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É">
    <svg viewBox="0 0 24 24">
      <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"></path>
    </svg>
  </button>

  <!-- –°–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã -->
  <script>
    const toggleBtn = document.getElementById('themeToggle');
    const bodyEl = document.body;
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º LocalStorage
    if(localStorage.getItem('theme') === 'dark') {
      bodyEl.classList.add('dark-mode');
    }

    toggleBtn.addEventListener('click', () => {
      bodyEl.classList.toggle('dark-mode');
      localStorage.setItem('theme', bodyEl.classList.contains('dark-mode') ? 'dark' : 'light');
    });
  </script>

  <div id="messageBox" style="position:fixed; bottom:20px; left:20px; background:#333; color:#fff; padding:10px 20px; border-radius:20px; opacity:0; pointer-events:none; transition:0.3s;"></div>

</body>
</html>
